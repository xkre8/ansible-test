---
- name: Get LVM information
  ansible.builtin.shell: |
    echo "=== VOLUME GROUPS ==="
    vgs "{{ volume_group_name }}" 2>/dev/null || echo "VG not found"
    echo ""
    echo "=== LOGICAL VOLUMES ==="
    lvs "{{ volume_group_name }}" 2>/dev/null || echo "No LVs found"
    echo ""
    {% if filesystem_dirs | length > 0 %}
    echo "=== MOUNT POINTS ==="
    df -h {{ filesystem_dirs | map(attribute='path') | join(' ') }} 2>/dev/null || echo "Mount info unavailable"
    {% else %}
    echo "=== NO FILESYSTEMS CONFIGURED ==="
    {% endif %}
  register: lvm_info
  changed_when: false
  failed_when: false

- name: Display LVM summary
  ansible.builtin.debug:
    msg: |
      
      ðŸŽ¯ LVM Setup Complete!
      Strategy: {{ vg_strategy | upper }}
      Volume Group: {{ volume_group_name }}
      {% if filesystem_dirs | length > 0 %}
      Filesystems Created: {{ filesystem_dirs | length }}
      {% else %}
      Filesystems Created: 0 (VG only)
      {% endif %}
      
      {{ lvm_info.stdout }}